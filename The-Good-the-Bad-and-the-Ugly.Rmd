---
title: "The Good, the Bad and the Ugly"
author: "Jack Carter"
date: "10/17/2021"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(tidyverse)
library(ggplot2)
library(stringr)
library(ggthemes)
library(here)

# gets the z score for a specific term. 
get_z_score <- function(data) {
  mean <- mean(
    data
    )
  sigma <- sd(
    data
  )
  z_scores <- list()
  for(i in 1:length(data)) {
    z_scores[i] <- (data[i] - mean) / sigma
  }
  return(unlist(
    z_scores
    ))
}

# gets the z score for a list of terms. 
get_z_scores <- function(data) {
  groups <- data %>%
    group_split(
      term
      )
  z_scores <- list()
  for(i in 1:length(groups)) {
    z_scores[i] <- list(
      get_z_score(groups[[i]]$hits)
      )
  }
  return(unlist(
    z_scores
    ))
}

national_belonging <- c("patriotism",
                        "nationalism",
                        "national identity")

disinformation <- c("conspiracy",
                    "disinformation",
                    "falsehoods")

partisanship <- c("partisan politics",
                  "political polarization",
                  "political differences")

discrimination <- c("racism",
                    "sexism",
                    "hate speech")

extreme_groups <- c("the far-right",
                    "white nationalists",
                    "white supremacists")

# read in data. 
data <- read_csv("data.csv")

# sort data alphabetically by term. 
index <- order(
  data$term
  )
sorted_data_frame <- data[index,]

# change term to upper case. 
sorted_data_frame$term <- str_to_title(sorted_data_frame$term)

# my personal plot theme for data visualizations. 
my_theme <- theme_economist_white(gray_bg = FALSE) +
  theme(plot.title = element_text(hjust = 0.5, 
                                  vjust = 13, 
                                  size = 8, 
                                  color = "#474747"),
        plot.margin = unit(c(1.5, 1, 1.5, 1), "cm"),
        axis.text = element_text(size = 9, 
                                 color = "gray30"),
        axis.text.x=element_text(vjust = -2.5),
        axis.title.x = element_text(size = 9, 
                                    color = "gray30", 
                                    vjust = -10),
        axis.title.y = element_text(size = 9, 
                                    color = "gray30", 
                                    vjust = 10),
        legend.direction = "vertical", 
        legend.position = "right",
        legend.title = element_blank(),
        legend.text = element_text(size = 10, 
                                   color = "gray20"),
        legend.margin=margin(1, -15, 1, 0),
        legend.spacing.x = unit(0.25, "cm"),
        legend.key.size = unit(1, "cm"), 
        legend.key.height = unit(0.75, "cm"),
        strip.text = element_text(hjust = 0.5, 
                                  vjust = 1, 
                                  size = 10, 
                                  color = "#474747"),
        panel.spacing = unit(2, "lines"))

```

## **Summary**
This project shows how the conversation in the New York Times (NYT) turned for the worse following the 2016 election of Donald Trump. A strong sense of national belonging is undoubtedly good for any country, yet Trump's rise was also accompanied by disinformation, polarization, discrimination and the emboldening of extreme groups. While this data may indicate a decline in some of these trends following Joe Biden's 2020 victory, the underlying views of many Americans who do not read or contribute to the NYT have likely not changed. 

&nbsp;

## **Method**

**1) Data Collection:**

The data used in this study are collected from the NYT API. They include metadata that indicate the number of articles containing certain terms for each year between 2011 and 2021. 

**2) Z Scores:**

The z scores are calculated as the raw number of articles less the term's mean, divided by the term's standard deviation. This allows for a comparison of the relative trajectory of terms. 

**2) Loess Transformation:**

The data for each term is then plotted with the use of a loess regression line. This smooths out the data points into a curve for a better visualization of overall trends. 

&nbsp;

## 1) The Good

```{r, echo = FALSE, message = FALSE, warning = FALSE, dpi=600}

# national belonging. 
sorted_data_frame %>% 
  mutate(
    z_score = get_z_scores(sorted_data_frame)
  ) %>%
  filter(
    term %in% str_to_title(national_belonging)
  ) %>%
  ggplot(
    aes(x=year, y=z_score, col=term)
  ) +
  geom_smooth(
    se=F, span = 0.5, size = 0.5
  ) +
  geom_vline(
    xintercept = 2016, col="darkgrey"
  ) +
  geom_vline(
    xintercept = 2020, col="darkgrey"
  ) +
  ggtitle(
    "National Belonging"
  ) +
  ylab(
    "Z Score"
  ) +
  xlab(
    "Year"
  ) + 
  ylim(
    -2, 2.4
  ) +
  my_theme

```

## 2) The Bad

```{r, echo = FALSE, message = FALSE, warning = FALSE, dpi=600}

# disinformation. 
sorted_data_frame %>% 
  mutate(
    z_score = get_z_scores(sorted_data_frame)
  ) %>%
  filter(
    term %in% str_to_title(disinformation)
  ) %>%
  ggplot(
    aes(x=year, y=z_score, col=term)
  ) +
  geom_smooth(
    se=F, span = 0.5, size = 0.5
  ) +
  geom_vline(
    xintercept = 2016, col="darkgrey"
  ) +
  geom_vline(
    xintercept = 2020, col="darkgrey"
  ) +
  ggtitle(
    "Disinformation"
  ) +
  ylab(
    "Z Score"
  ) +
  xlab(
    "Year"
    ) + 
  ylim(
    -2, 2.4
  ) +
  my_theme

# partisanship.   
sorted_data_frame %>% 
  mutate(
    z_score = get_z_scores(sorted_data_frame)
  ) %>%
  filter(
    term %in% str_to_title(partisanship)
  ) %>%
  ggplot(
    aes(x=year, y=z_score, col=term)
  ) +
  geom_smooth(
    se=F, span = 0.5, size = 0.5
  ) +
  geom_vline(
    xintercept = 2016, col="darkgrey"
  ) +
  geom_vline(
    xintercept = 2020, col="darkgrey"
  ) +
  ggtitle(
    "Political Polarization"
  ) +
  ylab(
    "Z Score"
  ) +
  xlab(
    "Year"
  ) + 
  ylim(
    -2, 2.4
  ) +
  my_theme

```

## 3) The Ugly

```{r, echo = FALSE, message = FALSE, warning = FALSE, dpi=600}

# discrimination.   
sorted_data_frame %>% 
  mutate(
    z_score = get_z_scores(sorted_data_frame)
  ) %>%
  filter(
    term %in% str_to_title(discrimination)
  ) %>%
  ggplot(
    aes(x=year, y=z_score, col=term)
  ) +
  geom_smooth(
    se=F, span = 0.5, size = 0.5
  ) +
  geom_vline(
    xintercept = 2016, col="darkgrey"
  ) +
  geom_vline(
    xintercept = 2020, col="darkgrey"
  ) +
  ggtitle(
    "Discrimination"
  ) +
  ylab(
    "Z Score"
  ) +
  xlab(
    "Year"
  ) + 
  ylim(
    -2, 2.4
  ) +
  my_theme

# extreme groups.     
sorted_data_frame %>% 
  mutate(
    z_score = get_z_scores(sorted_data_frame)
  ) %>%
  filter(
    term %in% str_to_title(extreme_groups)
  ) %>%
  ggplot(
    aes(x=year, y=z_score, col=term)
  ) +
  geom_smooth(
    se=F, span = 0.5, size = 0.5
  ) +
  geom_vline(
    xintercept = 2016, col="darkgrey"
  ) +
  geom_vline(
    xintercept = 2020, col="darkgrey"
  ) +
  ggtitle(
    "Extreme groups"
  ) +
  ylab(
    "Z Score"
  ) +
  xlab(
    "Year"
  ) + 
  ylim(
    -2, 2.4
  ) +
  my_theme

```

&nbsp;

## **Sources**

- New York Times (2021) https://developer.nytimes.com/apis

- Statology (2021) https://www.statology.org/interpret-z-scores/

&nbsp;
&nbsp;
&nbsp;

